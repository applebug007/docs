---
title: "Password Reset & Management"
openapi: "POST /forgot-password"
---

## Overview

Password reset and management endpoints provide secure password recovery and change functionality. These endpoints handle the complete password reset flow from initial request to password update, with built-in security features including rate limiting and token validation.

## Password Reset Flow

1. **Request Reset**: User provides email via `/forgot-password`
2. **Email Sent**: System sends secure reset token via email
3. **Reset Password**: User submits new password with token via `/reset-password`
4. **Confirmation**: User receives password change notification

---

## Forgot Password Endpoint

### POST /forgot-password

Initiate password reset process by sending a secure reset token to the user's email address.

**Purpose**: Generate and send password reset tokens while preventing email enumeration attacks and implementing rate limiting.

#### Request Parameters

### JSON Body Parameters

<ParamField body="email" type="string" required>
  Email address for the password reset request.
  
  **Format**: Valid email address  
  **Example**: `"user@example.com"`  
  **Case**: Automatically converted to lowercase
</ParamField>

#### Request Example

```json
{
  "email": "user@example.com"
}
```

#### Response Format

### Success Response (200)

```json
{
  "success": true,
  "message": "If an account with this email exists, you will receive a password reset email shortly."
}
```

<ResponseField name="success" type="boolean">
  Indicates the request was processed successfully
</ResponseField>

<ResponseField name="message" type="string">
  Standard message returned regardless of whether email exists (security measure)
</ResponseField>

### Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Email">
    ```json
    {
      "success": false,
      "message": "Email is required"
    }
    ```
    **Cause**: No email provided in request body  
    **Solution**: Include valid email address
  </Accordion>
  
  <Accordion title="429 - Rate Limited">
    ```json
    {
      "success": false,
      "message": "Too many password reset requests. Please wait before trying again.",
      "retryAfter": 3540
    }
    ```
    **Cause**: Exceeded rate limit (3 requests per hour per IP/email)  
    **Solution**: Wait for the specified retry period
  </Accordion>
  
  <Accordion title="500 - Internal Server Error">
    ```json
    {
      "success": false,
      "message": "Internal server error"
    }
    ```
    **Cause**: Server error during processing  
    **Solution**: Retry request or contact support
  </Accordion>
</AccordionGroup>

---

## Reset Password Endpoint

### POST /reset-password

Complete the password reset process using a valid reset token and new password.

**Purpose**: Validate reset tokens and update user passwords securely with proper token lifecycle management.

#### Request Parameters

### JSON Body Parameters

<ParamField body="token" type="string" required>
  Password reset token received via email.
  
  **Format**: 64-character hexadecimal string  
  **Example**: `"a1b2c3d4e5f6..."`  
  **Expiry**: Valid for 1 hour from generation
</ParamField>

<ParamField body="password" type="string" required>
  New password for the user account.
  
  **Minimum length**: 8 characters  
  **Example**: `"newSecurePassword123"`  
  **Security**: Automatically hashed before storage
</ParamField>

#### Request Example

```json
{
  "token": "a1b2c3d4e5f6789abc123def456ghi789jkl012mno345pqr678stu901vwx234yz",
  "password": "newSecurePassword123"
}
```

#### Response Format

### Success Response (200)

```json
{
  "success": true,
  "message": "Password reset successful. You can now log in with your new password."
}
```

<ResponseField name="success" type="boolean">
  Indicates password was reset successfully
</ResponseField>

<ResponseField name="message" type="string">
  Confirmation message for successful password reset
</ResponseField>

### Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Required Fields">
    ```json
    {
      "success": false,
      "message": "Token and password are required"
    }
    ```
    **Cause**: Missing token or password in request  
    **Solution**: Include both token and password
  </Accordion>
  
  <Accordion title="400 - Password Too Short">
    ```json
    {
      "success": false,
      "message": "Password must be at least 8 characters long"
    }
    ```
    **Cause**: Password shorter than minimum requirement  
    **Solution**: Use password with at least 8 characters
  </Accordion>
  
  <Accordion title="400 - Invalid Token">
    ```json
    {
      "success": false,
      "message": "Invalid or expired reset token"
    }
    ```
    **Cause**: Token not found, expired, or already used  
    **Solution**: Request new password reset
  </Accordion>
  
  <Accordion title="400 - Expired Token">
    ```json
    {
      "success": false,
      "message": "Reset token has expired"
    }
    ```
    **Cause**: Token older than 1 hour  
    **Solution**: Request new password reset
  </Accordion>
  
  <Accordion title="400 - Token Already Used">
    ```json
    {
      "success": false,
      "message": "Reset token has already been used"
    }
    ```
    **Cause**: Token was previously used for password reset  
    **Solution**: Request new password reset if needed
  </Accordion>
</AccordionGroup>

---

## Change Password Endpoint

### POST /api/auth/change-password

Change password for authenticated users (proxy to auth service).

**Purpose**: Allow authenticated users to change their password by proxying requests to the authentication service.

#### Request Parameters

### Headers

<ParamField header="Authorization" type="string" required>
  Bearer token for authenticated user.
  
  **Format**: `Bearer <token>`  
  **Example**: `"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."`
</ParamField>

### JSON Body Parameters

<ParamField body="currentPassword" type="string" required>
  User's current password for verification.
  
  **Example**: `"currentPassword123"`
</ParamField>

<ParamField body="newPassword" type="string" required>
  New password to set for the account.
  
  **Minimum length**: 8 characters  
  **Example**: `"newSecurePassword123"`
</ParamField>

#### Request Example

```json
{
  "currentPassword": "currentPassword123",
  "newPassword": "newSecurePassword123"
}
```

#### Response Format

Responses are proxied from the authentication service and may vary based on the auth service implementation.

---

## Code Examples

<CodeGroup>
```bash cURL
# Request password reset
curl -X POST "http://localhost:3000/forgot-password" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com"
  }'

# Reset password with token
curl -X POST "http://localhost:3000/reset-password" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "a1b2c3d4e5f6789abc123def456ghi789jkl012mno345pqr678stu901vwx234yz",
    "password": "newSecurePassword123"
  }'

# Change password (authenticated)
curl -X POST "http://localhost:3000/api/auth/change-password" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -d '{
    "currentPassword": "oldPassword123",
    "newPassword": "newSecurePassword123"
  }'
```

```javascript JavaScript
class PasswordManager {
    constructor(baseUrl = 'http://localhost:3000') {
        this.baseUrl = baseUrl;
    }

    async requestPasswordReset(email) {
        /**
         * Request password reset for email address
         * 
         * @param {string} email - User's email address
         * @returns {Object} Response object
         */
        try {
            const response = await fetch(`${this.baseUrl}/forgot-password`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email })
            });

            const result = await response.json();

            if (!response.ok) {
                throw new Error(result.message || `HTTP ${response.status}`);
            }

            return result;

        } catch (error) {
            console.error('Password reset request failed:', error);
            throw error;
        }
    }

    async resetPassword(token, password) {
        /**
         * Reset password using token
         * 
         * @param {string} token - Reset token from email
         * @param {string} password - New password
         * @returns {Object} Response object
         */
        try {
            if (password.length < 8) {
                throw new Error('Password must be at least 8 characters long');
            }

            const response = await fetch(`${this.baseUrl}/reset-password`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ token, password })
            });

            const result = await response.json();

            if (!response.ok) {
                throw new Error(result.message || `HTTP ${response.status}`);
            }

            return result;

        } catch (error) {
            console.error('Password reset failed:', error);
            throw error;
        }
    }

    async changePassword(currentPassword, newPassword, authToken) {
        /**
         * Change password for authenticated user
         * 
         * @param {string} currentPassword - Current password
         * @param {string} newPassword - New password
         * @param {string} authToken - Authentication token
         * @returns {Object} Response object
         */
        try {
            if (newPassword.length < 8) {
                throw new Error('New password must be at least 8 characters long');
            }

            const response = await fetch(`${this.baseUrl}/api/auth/change-password`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${authToken}`
                },
                body: JSON.stringify({
                    currentPassword,
                    newPassword
                })
            });

            const result = await response.json();

            if (!response.ok) {
                throw new Error(result.message || `HTTP ${response.status}`);
            }

            return result;

        } catch (error) {
            console.error('Password change failed:', error);
            throw error;
        }
    }
}

// Example usage
const passwordManager = new PasswordManager();

// Password reset flow
async function handlePasswordReset() {
    try {
        // Step 1: Request reset
        const resetRequest = await passwordManager.requestPasswordReset('user@example.com');
        console.log('Reset email sent:', resetRequest.message);

        // Step 2: User gets token from email and submits new password
        // This would typically happen on a different page/session
        const token = 'token-from-email'; // From user input
        const newPassword = 'newSecurePassword123'; // From user input

        const resetResult = await passwordManager.resetPassword(token, newPassword);
        console.log('Password reset successful:', resetResult.message);

    } catch (error) {
        console.error('Password reset error:', error.message);
    }
}

// Password change for authenticated user
async function handlePasswordChange() {
    try {
        const authToken = localStorage.getItem('authToken');
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;

        const changeResult = await passwordManager.changePassword(
            currentPassword, 
            newPassword, 
            authToken
        );
        
        console.log('Password changed successfully:', changeResult.message);
        
        // Clear form
        document.getElementById('passwordChangeForm').reset();
        
    } catch (error) {
        console.error('Password change error:', error.message);
        alert(`Password change failed: ${error.message}`);
    }
}

// Form validation
function validatePasswordForm(password, confirmPassword) {
    const errors = [];
    
    if (password.length < 8) {
        errors.push('Password must be at least 8 characters long');
    }
    
    if (password !== confirmPassword) {
        errors.push('Passwords do not match');
    }
    
    if (!/[A-Z]/.test(password)) {
        errors.push('Password must contain at least one uppercase letter');
    }
    
    if (!/[a-z]/.test(password)) {
        errors.push('Password must contain at least one lowercase letter');
    }
    
    if (!/[0-9]/.test(password)) {
        errors.push('Password must contain at least one number');
    }
    
    return errors;
}
```

```python Python
import requests
import json
from typing import Dict, Optional

class PasswordManager:
    def __init__(self, base_url: str = "http://localhost:3000"):
        self.base_url = base_url

    def request_password_reset(self, email: str) -> Dict:
        """
        Request password reset for email address
        
        Args:
            email: User's email address
            
        Returns:
            Response dictionary
        """
        url = f"{self.base_url}/forgot-password"
        payload = {"email": email}
        
        try:
            response = requests.post(
                url,
                json=payload,
                headers={"Content-Type": "application/json"},
                timeout=30
            )
            
            result = response.json()
            
            if not response.ok:
                raise Exception(result.get('message', f'HTTP {response.status_code}'))
            
            return result
            
        except requests.exceptions.RequestException as e:
            raise Exception(f"Password reset request failed: {e}")

    def reset_password(self, token: str, password: str) -> Dict:
        """
        Reset password using token
        
        Args:
            token: Reset token from email
            password: New password
            
        Returns:
            Response dictionary
        """
        if len(password) < 8:
            raise ValueError("Password must be at least 8 characters long")
        
        url = f"{self.base_url}/reset-password"
        payload = {
            "token": token,
            "password": password
        }
        
        try:
            response = requests.post(
                url,
                json=payload,
                headers={"Content-Type": "application/json"},
                timeout=30
            )
            
            result = response.json()
            
            if not response.ok:
                raise Exception(result.get('message', f'HTTP {response.status_code}'))
            
            return result
            
        except requests.exceptions.RequestException as e:
            raise Exception(f"Password reset failed: {e}")

    def change_password(self, current_password: str, new_password: str, auth_token: str) -> Dict:
        """
        Change password for authenticated user
        
        Args:
            current_password: Current password
            new_password: New password
            auth_token: Authentication token
            
        Returns:
            Response dictionary
        """
        if len(new_password) < 8:
            raise ValueError("New password must be at least 8 characters long")
        
        url = f"{self.base_url}/api/auth/change-password"
        payload = {
            "currentPassword": current_password,
            "newPassword": new_password
        }
        headers = {
            "Content-Type": "application/json",
            "Authorization": f"Bearer {auth_token}"
        }
        
        try:
            response = requests.post(
                url,
                json=payload,
                headers=headers,
                timeout=30
            )
            
            result = response.json()
            
            if not response.ok:
                raise Exception(result.get('message', f'HTTP {response.status_code}'))
            
            return result
            
        except requests.exceptions.RequestException as e:
            raise Exception(f"Password change failed: {e}")

def validate_password(password: str) -> list:
    """
    Validate password strength
    
    Args:
        password: Password to validate
        
    Returns:
        List of validation errors (empty if valid)
    """
    errors = []
    
    if len(password) < 8:
        errors.append("Password must be at least 8 characters long")
    
    if not any(c.isupper() for c in password):
        errors.append("Password must contain at least one uppercase letter")
    
    if not any(c.islower() for c in password):
        errors.append("Password must contain at least one lowercase letter")
    
    if not any(c.isdigit() for c in password):
        errors.append("Password must contain at least one number")
    
    return errors

# Example usage
def main():
    password_manager = PasswordManager()
    
    try:
        # Password reset flow
        print("Requesting password reset...")
        reset_request = password_manager.request_password_reset("user@example.com")
        print(f"Reset email sent: {reset_request['message']}")
        
        # Simulate user getting token from email
        token = input("Enter reset token from email: ")
        new_password = input("Enter new password: ")
        
        # Validate password
        validation_errors = validate_password(new_password)
        if validation_errors:
            print("Password validation errors:")
            for error in validation_errors:
                print(f"  - {error}")
            return
        
        # Reset password
        reset_result = password_manager.reset_password(token, new_password)
        print(f"Password reset successful: {reset_result['message']}")
        
    except Exception as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    main()
```
</CodeGroup>

## Security Features

### Rate Limiting

- **Limit**: 3 password reset requests per hour per IP/email combination
- **Window**: 1 hour sliding window
- **Response**: `429 Too Many Requests` with retry time

### Token Security

- **Generation**: Cryptographically secure random tokens (32 bytes)
- **Expiry**: 1 hour from generation
- **Single Use**: Tokens are marked as used after successful reset
- **Cleanup**: All user tokens deleted after successful reset

### Email Enumeration Protection

- **Consistent Response**: Same message whether email exists or not
- **No Information Leak**: Responses don't reveal account existence
- **Silent Failure**: Invalid emails fail silently with success message

### Password Security

- **Minimum Length**: 8 characters required
- **Hashing**: Passwords are hashed before storage
- **Validation**: Server-side validation of all requirements

## Best Practices

### Frontend Implementation

```javascript
// Rate limit handling
function handleRateLimit(response) {
    if (response.status === 429) {
        const retryAfter = response.retryAfter || 3600; // seconds
        const minutes = Math.ceil(retryAfter / 60);
        
        return `Too many attempts. Please try again in ${minutes} minutes.`;
    }
    return null;
}

// Password strength indicator
function getPasswordStrength(password) {
    let score = 0;
    
    if (password.length >= 8) score++;
    if (/[A-Z]/.test(password)) score++;
    if (/[a-z]/.test(password)) score++;
    if (/[0-9]/.test(password)) score++;
    if (/[^A-Za-z0-9]/.test(password)) score++;
    
    const levels = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong'];
    return levels[Math.min(score, 4)];
}
```

### Error Handling

```javascript
function handlePasswordError(error) {
    const errorMessages = {
        'Token and password are required': 'Please fill in all fields',
        'Password must be at least 8 characters long': 'Password too short',
        'Invalid or expired reset token': 'Link expired, please request a new reset',
        'Reset token has already been used': 'Link already used, please request a new reset'
    };
    
    return errorMessages[error.message] || error.message;
}
```

<Info>
**Token Delivery**: Reset tokens are sent via email. Ensure email service is properly configured for token delivery.
</Info>

<Warning>
**Token Security**: Reset tokens are sensitive. Never log tokens or expose them in URLs. Always use HTTPS in production.
</Warning>

<Note>
**Database Dependencies**: These endpoints require database connectivity for token storage and user management. Ensure proper database configuration.
</Note>
